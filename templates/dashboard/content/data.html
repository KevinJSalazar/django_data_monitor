<main class="h-full overflow-y-auto">
  <div class="container px-6 mx-auto grid">
    <h2 class="my-6 text-2xl font-semibold text-gray-700 dark:text-gray-200">

      <!-- START - título secundario -->
      {{ title }}
      <!-- END - título secundario -->

    </h2>

    <!-- Indicadores -->
    <div class="grid gap-6 mb-8 md:grid-cols-2 xl:grid-cols-4">

      <!-- Indicador -->
      <div class="flex items-center p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
        <div class="p-3 mr-4 text-orange-500 bg-orange-100 rounded-full dark:text-orange-100 dark:bg-orange-500">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path
              d="M18 10c0 3.866-3.582 7-8 7a8.96 8.96 0 01-4.39-1.13L2 17l1.13-3.39A8.96 8.96 0 012 10c0-3.866 3.582-7 8-7s8 3.134 8 7z">
            </path>
          </svg>
        </div>
        <div>
          <p class="mb-2 text-sm font-medium text-gray-600 dark:text-gray-400">
            Número total de respuestas
          </p>
          <p class="text-lg font-semibold text-gray-700 dark:text-gray-200">
            <!-- START - valor del indicador 1 -->
            {{ total_responses }}
            <!-- END - valor del indicador 1 -->
          </p>
        </div>
      </div>

      <!-- Indicador -->
      <div class="flex items-center p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
        <div class="p-3 mr-4 text-green-500 bg-green-100 rounded-full dark:text-green-100 dark:bg-green-500">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path d="M10 10a4 4 0 100-8 4 4 0 000 8zm-7 8a7 7 0 1114 0H3z">
            </path>
          </svg>
        </div>
        <div>
          <p class="mb-2 text-sm font-medium text-gray-600 dark:text-gray-400">
            Usuarios únicos
          </p>
          <p class="text-lg font-semibold text-gray-700 dark:text-gray-200">

            <!-- START - valor del indicador 2 -->
            {{ total_users }}
            <!-- END - valor del indicador 2 -->

          </p>
        </div>
      </div>

      <!-- Indicador -->
      <div class="flex items-center p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
        <div class="p-3 mr-4 text-blue-500 bg-blue-100 rounded-full dark:text-blue-100 dark:bg-blue-500">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path
              d="M2.94 6.94A2 2 0 014 6h12a2 2 0 011.06.94l-7.06 4.41-7.06-4.41zM18 8.58V14a2 2 0 01-2 2H4a2 2 0 01-2-2V8.58l8 5.02 8-5.02z">
            </path>
          </svg>
        </div>
        <div>
          <p class="mb-2 text-sm font-medium text-gray-600 dark:text-gray-400">
            Correos Únicos
          </p>
          <p class="text-lg font-semibold text-gray-700 dark:text-gray-200">

            <!-- START - valor del indicador 3 -->
            {{ total_emails }}
            <!-- END - valor del indicador 3 -->

          </p>
        </div>
      </div>

      <!-- Indicador -->
      <div class="flex items-center p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
        <div class="p-3 mr-4 text-teal-500 bg-teal-100 rounded-full dark:text-teal-100 dark:bg-teal-500">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path d="M2 5a2 2 0 012-2h12a2 2 0 012 2v10a2 2 0 01-2 2H6l-4 4V5z">
            </path>
          </svg>
        </div>
        <div>
          <p class="mb-2 text-sm font-medium text-gray-600 dark:text-gray-400">
            Mensajes Distintos
          </p>
          <p class="text-lg font-semibold text-gray-700 dark:text-gray-200">

            <!-- START - valor del indicador 4 -->
            {{ total_messages }}
            <!-- END - valor del indicador 4 -->

          </p>
        </div>
      </div>

    </div>

    <div class="grid gap-6 mb-8 md:grid-cols-2">

      <!-- BEGIN - Datos -->
      <div class="row-span-1 w-full overflow-hidden rounded-lg shadow-xs mb-6">

        <div class="w-full overflow-x-auto">
          <table class="w-full whitespace-no-wrap">
            <thead>
              <tr
                class="text-xs font-semibold tracking-wide text-left text-gray-500 uppercase border-b dark:border-gray-700 bg-gray-50 dark:text-gray-400 dark:bg-gray-800">
                <th class="px-4 py-3">Usuarios</th>
                <th class="px-4 py-3">Mensaje</th>
              </tr>
            </thead>
            <tbody class="bg-white divide-y dark:divide-gray-700 dark:bg-gray-800">

              <!-- START - respuestas -->
              {% for row in table_rows %}
              <tr class="text-gray-700 dark:text-gray-400">
                <td class="px-4 py-3 text-sm">
                  {{ row.user }}
                </td>
                <td class="px-4 py-3 text-sm">
                  {{ row.message }}
                </td>
              </tr>
              {% endfor %}
              <!-- END - respuestas -->

            </tbody>
          </table>
        </div>
        <div
          class="grid px-4 py-3 text-xs font-semibold tracking-wide text-gray-500 uppercase border-t dark:border-gray-700 bg-gray-50 sm:grid-cols-9 dark:text-gray-400 dark:bg-gray-800">
          <span class="flex items-center col-span-3">
            <!-- START - # total de respuestas -->
            {{ total_responses }}
            <!-- END - # total de respuestas -->
            respuestas
          </span>
        </div>
      </div>
      <!-- END - Datos -->

      <!-- BEGIN - Gráficos -->
      <div class="row-span-1 grid gap-6 mb-8 md:grid-cols-12">
        <div class="min-w-0 p-4 bg-white rounded-lg shadow-xs dark:bg-gray-800">
          <h4 class="mb-4 font-semibold text-gray-800 dark:text-gray-300">
            Respuestas por fecha
          </h4>
          <canvas id="line"></canvas>
          <!-- Pasar datos como JSON seguro -->
          {{ chart_labels|json_script:"chart-labels" }}
          {{ chart_data|json_script:"chart-data" }}
          <script>
            // Variables globales para usar en charts-lines.js
            window.chartLabels = JSON.parse(document.getElementById('chart-labels').textContent);
            window.chartData = JSON.parse(document.getElementById('chart-data').textContent);
          </script>
          <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
          <script>
            const chartLabels = JSON.parse(document.getElementById('chart-labels').textContent);
            const chartData = JSON.parse(document.getElementById('chart-data').textContent);
            const ctx = document.getElementById('line').getContext('2d');
            const chart = new Chart(ctx, {
              type: 'line',
              data: {
                labels: chartLabels,
                datasets: [{
                  label: 'Respuestas',
                  data: chartData,
                  borderColor: 'rgba(54, 162, 235, 1)',
                  backgroundColor: 'rgba(54, 162, 235, 0.2)',
                  fill: true,
                  tension: 0.1
                }]
              },
              options: {
                responsive: true,
                plugins: {
                  legend: { display: false }
                }
              }
            });
          </script>
        </div>
      </div>
      <!-- END - Gráficos -->

    </div>

  </div>
</main>